[
  {
    "doctype": "Client Script",
    "dt": "Employee",
    "enabled": 1,
    "modified": "2025-04-22 03:20:48",
    "module": "Payroll Indonesia",
    "name": "Employee-Form",
    "script": "frappe.ui.form.on('Employee', {\n    status_pajak: function(frm) {\n        if (frm.doc.status_pajak) {\n            // Extract number from status pajak (e.g., K2 -> 2)\n            const match = frm.doc.status_pajak.match(/K(\\d)/);\n            if (match) {\n                frm.set_value('jumlah_tanggungan', parseInt(match[1]));\n            } else {\n                frm.set_value('jumlah_tanggungan', 0);\n            }\n            frm.refresh_field('jumlah_tanggungan');\n        }\n    },\n    \n    jabatan: function(frm) {\n        validateGolonganLevel(frm);\n    },\n    \n    golongan: function(frm) {\n        validateGolonganLevel(frm);\n    }\n});\n\nfunction validateGolonganLevel(frm) {\n    if (frm.doc.jabatan && frm.doc.golongan) {\n        frappe.call({\n            method: 'payroll_indonesia.payroll_indonesia.validations.validate_employee_golongan',\n            args: {\n                jabatan: frm.doc.jabatan,\n                golongan: frm.doc.golongan\n            },\n            callback: function(r) {\n                if (r.exc) {\n                    frappe.validated = false;\n                    frm.set_value('golongan', '');\n                }\n            }\n        });\n    }\n}",
    "view": "Form"
  }
]
